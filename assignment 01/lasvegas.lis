     1                                  ; Name: Tomas Oh
     2                                  ; Completion Date: -/-/-
     3                                  
     4                                  ; Begin code area
     5                                  extern printf       ; external C++ function to write to standard output
     6                                  extern scanf        ; external C++ function to read from standard input
     7                                  global lasvegas
     8                                  
     9                                  segment .data
    10                                      ; Declare some messages to the users
    11 00000000 506C6561736520656E-         initial_speed_prompt_message    db  "Please enter the speed for the intial segment of the trip (mph): ", 0
    11 00000009 746572207468652073-
    11 00000012 7065656420666F7220-
    11 0000001B 74686520696E746961-
    11 00000024 6C207365676D656E74-
    11 0000002D 206F66207468652074-
    11 00000036 72697020286D706829-
    11 0000003F 3A2000             
    12 00000042 466F7220686F77206D-         miles_prompt_message            db  "For how many miles will you maintain this average speed? ", 0
    12 0000004B 616E79206D696C6573-
    12 00000054 2077696C6C20796F75-
    12 0000005D 206D61696E7461696E-
    12 00000066 207468697320617665-
    12 0000006F 726167652073706565-
    12 00000078 643F2000           
    13 0000007C 576861742077696C6C-         final_speed_prompt_message      db  "What will be your speed during the final segment of the trip (mph)? ", 0
    13 00000085 20626520796F757220-
    13 0000008E 737065656420647572-
    13 00000097 696E67207468652066-
    13 000000A0 696E616C207365676D-
    13 000000A9 656E74206F66207468-
    13 000000B2 65207472697020286D-
    13 000000BB 7068293F2000       
    14 000000C1 596F75722061766572-         average_speed_message           db  "Your average speed will be %1.18lf", 0
    14 000000CA 616765207370656564-
    14 000000D3 2077696C6C20626520-
    14 000000DC 25312E31386C6600   
    15 000000E4 74686520746F74616C-         total_time_message              db  "the total travel time will be %1.18lf", 0
    15 000000ED 2074726176656C2074-
    15 000000F6 696D652077696C6C20-
    15 000000FF 62652025312E31386C-
    15 00000108 6600               
    16                                  
    17 0000010A 0000000000B06F40            two_hundred_fifty_three_point_five  dq 253.5
    18 00000112 0000000000000040            two_point_zero                      dq 2.0
    19                                  
    20 0000011A 257300                      string_format       db "%s", 0
    21 0000011D 256C6600                    eight_byte_format   db "%lf", 0
    22                                  
    23                                  
    24                                  ; Begin executable instructions
    25                                  segment .text
    26                                  
    27                                  lasvegas:
    28                                      ; Back up all the GPRs
    29 00000000 55                          push    rbp
    30 00000001 4889E5                      mov     rbp, rsp
    31 00000004 53                          push    rbx
    32 00000005 51                          push    rcx
    33 00000006 52                          push    rdx
    34 00000007 56                          push    rsi
    35 00000008 57                          push    rdi
    36 00000009 4150                        push    r8
    37 0000000B 4151                        push    r9
    38 0000000D 4152                        push    r10
    39 0000000F 4153                        push    r11
    40 00000011 4154                        push    r12
    41 00000013 4155                        push    r13
    42 00000015 4156                        push    r14
    43 00000017 4157                        push    r15
    44 00000019 9C                          pushf
    45                                  
    46                                      ; Prompt for the speed of the intial segment of the trip
    47 0000001A B800000000                  mov qword   rax, 0
    48 0000001F 48BF-                       mov         rdi, string_format
    48 00000021 [1A01000000000000] 
    49 00000029 48BE-                       mov         rsi, initial_speed_prompt_message
    49 0000002B [0000000000000000] 
    50 00000033 E8(00000000)                call        printf
    51 00000038 58                          pop rax
    52                                  
    53                                      ; Obtain the initial speed from standard input
    54 00000039 6A00                        push qword  0
    55 0000003B B800000000                  mov qword   rax, 0
    56 00000040 48BF-                       mov         rdi, eight_byte_format
    56 00000042 [1D01000000000000] 
    57 0000004A 4889E6                      mov         rsi, rsp
    58 0000004D E8(00000000)                call        scanf
    59 00000052 F2440F100424                movsd       xmm8, [rsp]
    60 00000058 58                          pop         rax
    61                                  
    62                                      ; Prompt for the number of miles that the speed will be maintained
    63 00000059 6A00                        push qword  0
    64 0000005B B800000000                  mov qword   rax, 0
    65 00000060 48BF-                       mov         rdi, string_format
    65 00000062 [1A01000000000000] 
    66 0000006A 48BE-                       mov         rsi, miles_prompt_message
    66 0000006C [4200000000000000] 
    67 00000074 E8(00000000)                call        printf
    68 00000079 58                          pop rax
    69                                  
    70                                      ; Obtain the number of miles that this speed will be maintained
    71 0000007A 6A00                        push qword  0
    72 0000007C B800000000                  mov qword   rax, 0
    73 00000081 48BF-                       mov         rdi, eight_byte_format
    73 00000083 [1D01000000000000] 
    74 0000008B 4889E6                      mov         rsi, rsp
    75 0000008E E8(00000000)                call        scanf
    76 00000093 F2440F100C24                movsd       xmm9, [rsp]
    77 00000099 58                          pop         rax
    78                                  
    79                                      ; Prompt for the speed of the final segment of the trip
    80 0000009A 6A00                        push qword  0
    81 0000009C B800000000                  mov qword   rax, 0
    82 000000A1 48BF-                       mov         rdi, string_format
    82 000000A3 [1A01000000000000] 
    83 000000AB 48BE-                       mov         rsi, final_speed_prompt_message
    83 000000AD [7C00000000000000] 
    84 000000B5 E8(00000000)                call        printf
    85 000000BA 58                          pop rax
    86                                  
    87                                      ; Obtain the final speed from standard input
    88 000000BB 6A00                        push qword  0
    89 000000BD B800000000                  mov qword   rax, 0
    90 000000C2 48BF-                       mov         rdi, eight_byte_format
    90 000000C4 [1D01000000000000] 
    91 000000CC 4889E6                      mov         rsi, rsp
    92 000000CF E8(00000000)                call        scanf
    93 000000D4 F2440F101424                movsd       xmm10, [rsp]
    94 000000DA 58                          pop         rax
    95                                  
    96                                      ; We have x initial speed and it is maintained for the first y miles
    97                                      ; The number of hours passed is equal to y / x
    98 000000DB F2450F10D8                  movsd       xmm11, xmm8
    99 000000E0 F2450F5ED9                  divsd       xmm11, xmm9
   100 000000E5 58                          pop         rax
   101                                  
   102 000000E6 B801000000                  mov         rax, 1
   103 000000EB 48BF-                       mov         rdi, string_format
   103 000000ED [1A01000000000000] 
   104 000000F5 48BE-                       mov         rsi, average_speed_message
   104 000000F7 [C100000000000000] 
   105 000000FF F2410F10C3                  movsd       xmm0, xmm11
   106 00000104 E8(00000000)                call        printf
   107                                      
   108                                      ; movsd       xmm4, qword two_hundred_fifty_three_point_five
   109                                  
   110                                      ; Set return value now
   111 00000109 4156                        push        r14
   112 0000010B F20F100424                  movsd       xmm0, [rsp]
   113 00000110 415E                        pop         r14
   114                                  
   115                                      ; Restoring the original value to the GPRs
   116 00000112 9D                          popf
   117 00000113 415F                        pop        r15
   118 00000115 415E                        pop        r14
   119 00000117 415D                        pop        r13
   120 00000119 415C                        pop        r12
   121 0000011B 415B                        pop        r11
   122 0000011D 415A                        pop        r10
   123 0000011F 4159                        pop        r9
   124 00000121 4158                        pop        r8
   125 00000123 5F                          pop        rdi
   126 00000124 5E                          pop        rsi
   127 00000125 5A                          pop        rdx
   128 00000126 59                          pop        rcx
   129 00000127 5B                          pop        rbx
   130 00000128 5D                          pop        rbp
   131                                  
   132 00000129 C3                          ret
   133                                  
   134                                  ; End of lasvegas.asm program
